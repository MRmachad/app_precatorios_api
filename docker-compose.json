{
  "version": "3.1",
  "services": {
    "db_app_precatorios": {
      "restart": "unless-stopped",
      "image": "mariadb:latest",
      "container_name": "db_app_precatorios",
      "environment": {
        "MARIADB_ROOT_PASSWORD": "qwerty"
      },
      "ports": [
        "5016:3306"
      ],
      "volumes": [
        "./mariadb_data_precatorios:/var/lib/mysql"
      ],
      "healthcheck": {
        "test": [
          "CMD",
          "healthcheck.sh",
          "--connect",
          "--innodb_initialized"
        ],
        "interval": "10s",
        "timeout": "5s",
        "retries": 3
      }
    },
    "hub_selenium": {
      "restart": "unless-stopped",
      "image": "selenium/hub:4.21.0",
      "container_name": "hub_selenium",
      "ports": [
        "4444:4444"
      ],
      "shm_size": "256mb"
    },
    "chrome-node-processo": {
      "restart": "unless-stopped",
      "image": "selenium/node-chrome:4.21.0",
      "container_name": "chrome-node-processo",
      "depends_on": [
        "hub_selenium"
      ],
      "environment": {
        "SE_EVENT_BUS_HOST": "hub_selenium",
        "SE_EVENT_BUS_PUBLISH_PORT": "4442",
        "SE_EVENT_BUS_SUBSCRIBE_PORT": "4443",
        "SE_NODE_MAX_SESSIONS": "5"
      },
      "ports": [
        "5900:5900"
      ],
      "shm_size": "526mb"
    },
    "chrome-node-meta": {
      "restart": "unless-stopped",
      "image": "selenium/node-chrome:4.21.0",
      "container_name": "chrome-node-meta",
      "depends_on": [
        "hub_selenium"
      ],
      "environment": {
        "SE_EVENT_BUS_HOST": "hub_selenium",
        "SE_EVENT_BUS_PUBLISH_PORT": "4442",
        "SE_EVENT_BUS_SUBSCRIBE_PORT": "4443",
        "SE_NODE_MAX_SESSIONS": "5"
      },
      "ports": [
        "5901:5900"
      ],
      "shm_size": "526mb"
    },
    "app_precatorios": {
      "restart": "unless-stopped",
      "container_name": "app_precatorios",
      "build": ".",
      "depends_on": {
        "db_app_precatorios": {
          "condition": "service_healthy"
        },
        "hub_selenium": {
          "condition": "service_started"
        }
      },
      "ports": [
        "5098:80"
      ],
      "shm_size": "256mb"
    }
  }
}